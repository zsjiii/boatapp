<!DOCTYPE html>  
<html>  
    <head>  

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<style type="text/css">
		body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;}
		#l-map{height:100%;width:78%;float:left;border-right:2px solid #bcbcbc;}
		#r-result{height:100%;width:20%;float:left;}
        .BMap_cpyCtrl {
            display:none;
        }

        .anchorBL {
            display: none;
        }
	</style>

	<script type="text/javascript" src="map_load.js"></script>
	<script type="text/javascript" src="MeasureTool.js"></script>
	<script type="text/javascript" src="qwebchannel.js"></script>
	<title>百度地图的Hello, World</title>

    </head>  

   <body>
	<div id="allmap"></div>
   </body>
 </html>
<script type="text/javascript">
/****************************************************定义一些后面用到的状态字、变量和数组****************************************************/
	var PointId=0;	
    var waymakers = [
    ];						//当前坐标点的数量

    var my_showlines = [];
    var ReadCenterPoints = new Array();		//读航点时航线居中的数组
    var PlanCenterPoints = new Array();		//规划航点时航线居中的数组
	var RouteStr=							//结构体数组，用于存储坐标点
	{
		id:Array(),							//坐标点的id
		lon:Array(),						//坐标的经度
		lat:Array(),						//坐标点的纬度
		num:Array()							//坐标点的数量，一般num = id + 1;
    };
    var i = 0;
    var DrawId = 0;
    var DrawStr =							//结构体数组，用于存储画框的点
    {
        id: Array(),							//坐标点的id
        lon1: Array(),						//坐标1的经度
        lat1: Array(),						//坐标1的纬度
        lon2: Array(),						//坐标2的经度
        lat2: Array(),
        num: Array()							//坐标点的数量，一般num = id + 1;
    };
    var my_polyline1 = [
    ];//航迹线虚线
    var my_polyline2 = [
    ];//航迹线实线
    var my_polylinenum = 0;
    var my_wayline;
    var my_drawline;
    var drawyunnan = [
    ];
    var DrawOverlayId = 0;
    var drawArr = [

    ]; //存储draw覆盖物的数组,暂时规定:0是警戒区，1是阻控区1，2是阻控区2

    var drawdlArr = [
    ];
    var doornum;
    var circlenum = 0;
    var draw1marker;
    var draw2marker;
	var marker4;
	var marker45;
	var marker31;
	var markership45;
	var markership31;
	var myboatIcon = new BMap.Icon("images/boat5.png", new BMap.Size(90,90),{imageSize: new BMap.Size(30,30), imageOffset: new BMap.Size(30,30)});
	var myboatIcon2 = new BMap.Icon("images/boat6.png", new BMap.Size(90,90))//, {imageSize: new BMap.Size(30,30), imageOffset: new BMap.Size(30,30)});

	var mydotIcon = new BMap.Icon("images/circle.png", new BMap.Size(16,16));

    var mywayIcon = new BMap.Icon("images/stop_icon1.png", new BMap.Size(16,16));
    var myshipIcon = new BMap.Icon("images/boat5.png", new BMap.Size(90, 90));
    var mydrawIcon = new BMap.Icon("images/button.png", new BMap.Size(12,12));

	var g_boatmarker;

	var mapOptions={

                minZoom: 5,
                maxZoom:23,
                }
    	var map = new BMap.Map("allmap", mapOptions);      // 设置街道图为底图
	var top_left_navigation = new BMap.NavigationControl();  //左上角，添加默认缩放平移控件
	
	 //map.centerAndZoom(new BMap.Point(120.089,36.256), 19);//ar1="102.8528",ar2="22.07833"
	 map.centerAndZoom(new BMap.Point(102.8683,24.3647), 16);//ar1="102.8528",ar2="22.07833"
	 //map.disableScrollWheelZoom();                            //禁用滚轮放大缩小   
	 //map.disableDragging();
	 map.setMapType(BMAP_SATELLITE_MAP);                                   
	 //map.addControl(new BMap.MapTypeControl());      
	 //map.disableDoubleClickZoom() //禁止缩放

	 function xufun(flg,lon,lat,rotate)
	 {
         		var xuxu = "Good,you are beautiful!";
		g_do_type = flg;
		switch(flg)
		{
			case 1:
				break;
			case 2://设置航点
                PointId = 0;
                var ccmarkers = map.getOverlays();
                for (i = 0; i < ccmarkers.length; i++) {
                    if ((ccmarkers[i].clear_tag == "hangxianpoint") || (ccmarkers[i].clear_tag == "hangxianline")){
                        map.removeOverlay(ccmarkers[i]);
                    }
                }
				xuxu="case 2 ready!"
				break;
            case 3://设置航线

                xuxu = "case 3 ready!"
				break;
			case 4://保存航线
               
                //map.removeOverlay(my_polyline);//清除航线
                PointId = 0;
                for (i = 1; i < RouteStr.num[0]; i++) {
                    map.removeOverlay(my_polyline1[i]);//清除航线
                }
				for(i = 1;i < RouteStr.num[0];i++)				//画线
                {
                    my_polylinenum = i;
                    
					OldLon = RouteStr.lon[i-1];
					OldLat = RouteStr.lat[i-1];
					lon = RouteStr.lon[i];
					lat = RouteStr.lat[i];
					Plan_drawLine(OldLon, OldLat, lon, lat, 2);
                }
                
                xuxu = "case 4 ready!"
				break;
            case 5:
                if (lon == 0 && lat == 0) {
                    break;
                }
                map.removeOverlay(g_boatmarker);
				var pt = new BMap.Point(lon, lat);//102.8528, 24.59878);
                g_boatmarker = new BMap.Marker(pt, { icon: myboatIcon, rotation: rotate });  // 创建标注

                map.addOverlay(g_boatmarker); // 将标注添加到地图中
                xuxu = "case 5 ready:" + lon + "," + lat;
                break;
            case 7:
                DrawOverlayId = 0;
                break;
            case 8:
                circlenum = 3;
                break;
            case 9:
                doornum = 5;
                break;
		}
         return xuxu;
    }


    var contextMenu = new BMap.ContextMenu();
    contextMenu.addItem(new BMap.MenuItem("打开航线列表", function (e) {
        mapcc_js.getCoordinate(99,99);
    }, 120));
    map.addContextMenu(contextMenu);
    contextMenu.addItem(new BMap.MenuItem("清除区域框", function (e) {
        
        for (i = 0; i < 4;i++) {
            map.removeOverlay(drawArr[i]);
        }
           
           map.removeOverlay(draw2marker);
           map.removeOverlay(draw1marker);
        
       }, 120));
    map.addContextMenu(contextMenu);
    contextMenu.addItem(new BMap.MenuItem("动作结束", function (e) {
        g_do_type = 1;
    }, 120));
    map.addContextMenu(contextMenu);
    contextMenu.addItem(new BMap.MenuItem("清除航线", function (e) {
        for (i = 0; i < 199; i++) {
            map.removeOverlay(my_polyline1[i]);
            map.removeOverlay(my_polyline2[i]);
        }
    }, 120));
    map.addContextMenu(contextMenu);
    contextMenu.addItem(new BMap.MenuItem("清除所有", function (e) {
        clear_all();
    }, 120));
    map.addContextMenu(contextMenu);

    map.addContextMenu(contextMenu);
    contextMenu.addItem(new BMap.MenuItem("清除航迹点", function (e) {
        var ccmarkers = map.getOverlays();
        for(i=0;i<ccmarkers.length;i++)
        {
            if (ccmarkers[i].clear_tag == "hangjipoint") {
                map.removeOverlay(ccmarkers[i]);
            }
	}
    }, 120));
    map.addContextMenu(contextMenu);

    map.addEventListener("click", function (e) {

            mapcc_js.getCoordinate(e.point.lng, e.point.lat);
            switch (g_do_type) {
                case 1:
                    //alert(e.point.lng + "," + e.point.lat);//信息框提示函数
					//


                    break;
                case 2:
					RouteStr.id[PointId] = PointId;							//将点击的点的信息存入数组
					RouteStr.lon[PointId] = e.point.lng;
					RouteStr.lat[PointId] = e.point.lat;
					RouteStr.num[0] = PointId+1;

					Plan_addPoint(e.point.lng, e.point.lat, PointId);		//执行添加点的功能程序

					if(PointId!=0)											//执行画线的功能程序
					{
						var oldLon = RouteStr.lon[PointId - 1];
						var oldLat = RouteStr.lat[PointId - 1];
						var Lon = RouteStr.lon[PointId];
						var Lat = RouteStr.lat[PointId];

                        my_polylinenum = PointId;
                        Plan_drawLine(oldLon, oldLat, Lon, Lat, 1);

					}

                    PointId = PointId+1;
	//添加点
					function Plan_addPoint(x, y, lebelnum) {
						
						var pt = new BMap.Point(x, y);
                        var marker = new BMap.Marker(pt);
                        marker.clear_tag = "hangxianpoint";
						map.addOverlay(marker);														//添加标注
						//marker.enableDragging();													//标注可拖拽
						var label = new BMap.Label(lebelnum, { offset: new BMap.Size(2.5,1) });
						marker.setLabel(label);														//添加标注上显示的点的id
						label._iID = lebelnum;

					}
                    break;
                case 3:
                    //overlays.push(e.overlay);
                    //var path = e.overlay.getPath();//Array<Point> 返回多边型的点数组

                    break;
				case 6:

					var myDis = new BMapLib.MeasureTool(map);
					myDis.open(); //开启鼠标测距

                    break;
                case 7:

                    var draw1 = new BMap.Point(e.point.lng, e.point.lat);
                    
                    DrawStr.id[DrawId] = DrawId;							//将点击的点的信息存入数组
                    DrawStr.lon1[DrawId] = e.point.lng;
                    DrawStr.lat1[DrawId] = e.point.lat;
                    DrawStr.num[0] = DrawId + 1;

                    draw1marker = new BMap.Marker(draw1, { icon: mydrawIcon });
                    map.addOverlay(draw1marker);
                    var draw2 = new BMap.Point(e.point.lng, e.point.lat);
                    draw2marker = new BMap.Marker(draw2, { icon: mydrawIcon });
                    map.addOverlay(draw2marker);
                    draw2marker.enableDragging();

                    mapcc_js.getpoint_quyu(1);
                    draw2marker.addEventListener("dragend", function (e)				//拖动标注结束
                    {
                   
                        
                        DrawStr.lon2[DrawId] = e.point.lng;					//获得拖动后点的坐标
                        DrawStr.lat2[DrawId] = e.point.lat;
                        map.removeOverlay(drawArr[DrawOverlayId]);
                        showkm11info(DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon1[DrawId], DrawStr.lat2[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId], DrawStr.lon2[DrawId], DrawStr.lat1[DrawId], DrawOverlayId);

                        var olddrawlon, olddrawlat, darwlon, drawlat;
                        olddrawlon = DrawStr.lon1[DrawId];
                        olddrawlat = DrawStr.lat1[DrawId];
                        darwlon = DrawStr.lon2[DrawId];
                        drawlat = DrawStr.lat2[DrawId];
                        //var markerMenu = new BMap.ContextMenu();
                        //markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                            //mapcc_js.getDraw(olddrawlon, olddrawlat, darwlon, drawlat, DrawOverlayId);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                            //g_do_type = 1;
                        //}, 120));
                        //drawArr[DrawOverlayId].addContextMenu(markerMenu);
                        DrawId++;
                        DrawOverlayId++;

                        mapcc_js.getpoint_quyu(2);
          
                    });
                    break;
                case 8:
                    var draw3 = new BMap.Point(e.point.lng, e.point.lat);
                    var circlelon, circlelat;
                    circlelon = e.point.lng;
                    circlelat = e.point.lat;
                    var draw3marker = new BMap.Marker(draw3, { icon: mydrawIcon });
                    map.addOverlay(draw3marker);
                    showkm11info(e.point.lng, e.point.lat, 50, 0, 0, 0, 0, 0, circlenum)

                    circlenum++;
		break;
                case 9:
                    var draw4 = new BMap.Point(e.point.lng, e.point.lat);
                    var doorlon, doorlat;
                    doorlon = e.point.lng;
                    doorlat = e.point.lat;
                    var draw4marker = new BMap.Marker(draw4, { icon: mydrawIcon });
                    map.addOverlay(draw4marker);
                    var angel4 = prompt("请输入角度");
                    var leng4 = prompt("请输入长度");
                    var draw5lon, draw5lat;
                    var arc = 6371.393 * 1000;
                    //angel4 = angel4 / 360 * Math.PI;
                    draw5lon = e.point.lng + leng4 * Math.sin(angel4) / (arc * Math.cos(e.point.lat) * 2 * Math.PI / 360);
                    draw5lat = e.point.lat + leng4 * Math.cos(angel4) / (arc * 2 * Math.PI / 360);
                    var draw5 = new BMap.Point(draw5lon, draw5lat);
                    var draw5marker = new BMap.Marker(draw5, { icon: mydrawIcon });
                    map.addOverlay(draw5marker);
                    
                    showkm11info(e.point.lng, e.point.lat, draw5lon, draw5lat, 0, 0, 0, 0, doornum);
                  
                    doornum++;
		            break;
                case 10:
                    var draw6 = new BMap.Point(e.point.lng, e.point.lat);
                    var circlelon, circlelat;
                    circlelon = e.point.lng;
                    circlelat = e.point.lat;
                    var draw6marker = new BMap.Marker(draw6, { icon: mydrawIcon });
                    map.addOverlay(draw6marker);
                    showkm11info(e.point.lng, e.point.lat, 50, 0, 0, 0, 0, 0, 8)
                    break;

	
            }

    }
    );

/****************************************************添加鼠标单击功能，使鼠标单击一下，产生一个坐标点并显示、记录****************************************************/


    //添加航线
    function Plan_drawLine(x1,y1,x2,y2,type)
	{

                    var styleOptions1 = {
                        //icons:[draw_line_direction(6)],
                        strokeWeight: '2',
                        strokeOpacity: 0.75,
                        strokeStyle: 'dashed',//'solid',//
                        strokeColor: 'white'
                    };
                    var styleOptions2 = {
                        //icons:[draw_line_direction(6)],
                        strokeWeight: '2',
                        strokeOpacity: 0.75,
                        strokeStyle: 'solid',//
                        strokeColor: 'red'
                    };
                    var styleOptions3 = {
                        //icons:[draw_line_direction(6)],
                        strokeWeight: '1',
                        strokeOpacity: 0.75,
                        strokeStyle: 'solid',//
                        strokeColor: 'black'
                    };
        var pointA = new BMap.Point(x1,y1);  																			// 创建点坐标A
        var pointB = new BMap.Point(x2,y2);  																		// 创建点坐标B
        if(type==1){
            my_polyline1[my_polylinenum] = new BMap.Polyline([pointA, pointB], styleOptions1);  	//定义折线
            my_polyline1[my_polylinenum].clear_tag = "hangxianline"
            map.addOverlay(my_polyline1[my_polylinenum]);
	}
        else if(type==2){
            my_polyline2[my_polylinenum] = new BMap.Polyline([pointA, pointB], styleOptions2);
            my_polyline2[my_polylinenum].clear_tag = "hangxianline"
            map.addOverlay(my_polyline2[my_polylinenum]);//定义折线
	}
        else if(type==3){
		my_wayline = new BMap.Polyline([pointA,pointB], styleOptions3);  	//定义折线
		map.addOverlay(my_wayline); 
	}
    																					//添加折线到地图上
    }

    //删除所有标记
    function clear_all()
	{
		map.clearOverlays();
     }


       function showway(lon, lat) {

        var point3 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
           var marker3 = new BMap.Marker(point3, { icon: mywayIcon, enableClicking: false });
           marker3.clear_tag = "hangjipoint";
        map.addOverlay(marker3);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showway ok:" + lon + "," + lat;
        return xuxu;
        }

       function ceshi(lon, lat) {

        var ceshipoint3 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
        var ceshimarker3 = new BMap.Marker(ceshipoint3);
        map.addOverlay(ceshimarker3);
        var xuxu = "Good,you are beautiful!";
        xuxu = "ceshi ok:" + lon + "," + lat;
        return xuxu;
        }

       function showwayl(lon, lat,oldlon,oldlat) {

	    //Plan_drawLine(lon,lat,oldlon,oldlat,3)
        var xuxu = "Good,you are beautiful!";
        xuxu = "showway ok:" + lon + "," + lat;
        return xuxu;
        }

        function showline(lon, lat, type, num) {
            if (type == 0) {

                my_showlines.push(new BMap.Point(lon, lat));
                var pt = new BMap.Point(lon, lat);
                var marker = new BMap.Marker(pt);
                marker.clear_tag = "hangxianpoint";
                map.addOverlay(marker);														//添加标注
                var label = new BMap.Label(num, { offset: new BMap.Size(2.5, 1) });
                marker.setLabel(label);														//添加标注上显示的点的id
                label._iID = num;
            }
            else if (type == 1) {
                var pt = new BMap.Point(lon, lat);
                var marker = new BMap.Marker(pt);
                marker.clear_tag = "hangxianpoint";
                map.addOverlay(marker);														//添加标注
                var label = new BMap.Label(num, { offset: new BMap.Size(2.5, 1) });
                marker.setLabel(label);														//添加标注上显示的点的id
                label._iID = num;
                my_showlines.push(new BMap.Point(lon, lat));
                var stylecc = {
                    strokeWeight: '2',
                    strokeOpacity: 0.75,
                    strokeStyle: 'solid',//
                    strokeColor: 'red'
                };
                var my_showline = new BMap.Polyline(my_showlines, stylecc);
                my_showline.clear_tag = "hangxianline"
                map.addOverlay(my_showline);
                my_showlines.splice(0);
                my_showlines.length = 0;

            }
        }


        function showship(lon, lat,ang) {

        var point4 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
        map.removeOverlay(marker4);
        marker4 = new BMap.Marker(point4, { icon: myboatIcon, rotation: ang });
        map.addOverlay(marker4);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showship ok:" + lon + "," + lat;
        return xuxu;
        }

        function showship45(lon, lat,ang) {

        var pointship45 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
        map.removeOverlay(markership45);
        markership45 = new BMap.Marker(pointship45 , { icon: myboatIcon2, rotation: ang });
        map.addOverlay(markership45);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showship45 ok:" + lon + "," + lat;
        return xuxu;
        }

       function showship31(lon, lat,ang) {

        var pointship31 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
        map.removeOverlay(markership31 );
        markership31 = new BMap.Marker(pointship31 , { icon: myboatIcon, rotation: ang });
        map.addOverlay(markership31 );

		//panTo(center: pointship31, opts: PanOptions);
		//map.panTo(pointship31);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showship31 ok:" + lon + "," + lat;
        return xuxu;
        }



       function showway45(lon, lat) {

        var point45 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
           var markerway45 = new BMap.Marker(point45, { icon: mywayIcon, enableClicking: false });
           markerway45.clear_tag = "hangjipoint";
        map.addOverlay(markerway45);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showway45 ok:" + lon + "," + lat;
        return xuxu;
        }

        function showway31(lon, lat) {

        var point31 = new BMap.Point(lon,lat);
        // 创建标注对象并添加到地图  
           var markerway31 = new BMap.Marker(point31, { icon: mywayIcon, enableClicking: false });
           markerway31.clear_tag = "hangjipoint";
        map.addOverlay(markerway31);
        var xuxu = "Good,you are beautiful!";
        xuxu = "showway31 ok:" + lon + "," + lat;
        return xuxu;
        }

    function showkm11info(lon1, lat1, lon2, lat2, lon3, lat3, lon4, lat4, type) {

	var style1 = { strokeColor: "red", strokeWeight: 2, strokeOpacity: 0.5,fillColor: "" };
	var style2 = { strokeColor: "black", strokeWeight: 2, strokeOpacity: 0.5,fillColor: "" };
	var style3 = { strokeColor: "blue", strokeWeight: 2, strokeOpacity: 0.5,fillColor: "" };
	var style4 = { strokeColor: "yellow", strokeWeight: 2, strokeOpacity: 0.5,fillColor: "" };

        if (type == 0) {
            //map.removeOverlay(drawArr[0]);
            drawArr[0] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style2);
            map.addOverlay(drawArr[0]);
            var markerMenu = new BMap.ContextMenu();
            markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                mapcc_js.getDraw(lon1, lat1, lon3, lat3, 0);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                g_do_type = 1;
            }, 120));
            drawArr[0].addContextMenu(markerMenu);
	drawArr[0].disableMassClear();
        }

        else if (type == 1) {
            //map.removeOverlay(drawArr[1]);
            drawArr[1] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style3);
            map.addOverlay(drawArr[1]);
            var markerMenu = new BMap.ContextMenu();
            markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                mapcc_js.getDraw(lon1, lat1, lon3, lat3, 1);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                g_do_type = 1;
            }, 120));
            drawArr[1].addContextMenu(markerMenu);
	drawArr[1].disableMassClear();
        }

        else if (type == 2) {
            //map.removeOverlay(drawArr[2]);
            drawArr[2] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style4);
            map.addOverlay(drawArr[2]);
            var markerMenu = new BMap.ContextMenu();
            markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                mapcc_js.getDraw(lon1, lat1, lon3, lat3, 2);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                g_do_type = 1;
            }, 120));
            drawArr[2].addContextMenu(markerMenu);
	drawArr[2].disableMassClear();
        }
        else if (type == 3) {
            //map.removeOverlay(drawArr[3]);
            drawArr[3] = new BMap.Circle(new BMap.Point(lon1, lat1), lon2, style3);
            map.addOverlay(drawArr[3]);
                    var markerMenu = new BMap.ContextMenu();
                    markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                        mapcc_js.getDraw(lon1, lat1, 50, 0, 3);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                        g_do_type = 1;
                    }, 120));
                    drawArr[3].addContextMenu(markerMenu);
	drawArr[3].disableMassClear();
        }
        else if (type == 4) {
            //map.removeOverlay(drawArr[4]);
            drawArr[4] = new BMap.Circle(new BMap.Point(lon1, lat1), lon2, style4);
            map.addOverlay(drawArr[4]);
                    var markerMenu = new BMap.ContextMenu();
                    markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                        mapcc_js.getDraw(lon1, lat1, 50, 0, 4);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                        g_do_type = 1;
                    }, 120));
                    drawArr[4].addContextMenu(markerMenu);
	drawArr[4].disableMassClear();
        }
        else if (type == 5) {
            //map.removeOverlay(drawArr[5]);
            drawArr[5] = new BMap.Polyline([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2)
            ], style2);
            map.addOverlay(drawArr[5]);
                    var markerMenu = new BMap.ContextMenu();
                    markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                        mapcc_js.getDraw(lon1, lat1, lon2, lat2, 5);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                        g_do_type = 1;
                    }, 120));
                    drawArr[5].addContextMenu(markerMenu);
	drawArr[5].disableMassClear();
        }
        else if (type == 6) {
            //map.removeOverlay(drawArr[6]);
            drawArr[6] = new BMap.Polyline([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2)
            ], style3);
            map.addOverlay(drawArr[6]);
                    var markerMenu = new BMap.ContextMenu();
                    markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                        mapcc_js.getDraw(lon1, lat1, lon2, lat2, 6);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                        g_do_type = 1;
                    }, 120));
                    drawArr[6].addContextMenu(markerMenu);
	drawArr[6].disableMassClear();
        }
        else if (type == 7) {
            //map.removeOverlay(drawArr[7]);
            drawArr[7] = new BMap.Polyline([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2)
            ], style4);
            map.addOverlay(drawArr[7]);
                    var markerMenu = new BMap.ContextMenu();
                    markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                        mapcc_js.getDraw(lon1, lat1, lon2, lat2, 7);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                        g_do_type = 1;
                    }, 120));
                    drawArr[7].addContextMenu(markerMenu);
	drawArr[7].disableMassClear();
        }
        else if (type == 8) {
            //map.removeOverlay(drawArr[8]);
            drawArr[8] = new BMap.Circle(new BMap.Point(lon1, lat1), lon2, style2);
            map.addOverlay(drawArr[8]);
            var markerMenu = new BMap.ContextMenu();
            markerMenu.addItem(new BMap.MenuItem('发送当前区域', function (e) {
                mapcc_js.getDraw(lon1, lat1, lon3, lat3, 8);//DrawStr.lon1[DrawId], DrawStr.lat1[DrawId], DrawStr.lon2[DrawId], DrawStr.lat2[DrawId]
                g_do_type = 1;
            }, 120));
            drawArr[8].addContextMenu(markerMenu);
	drawArr[8].disableMassClear();
        }

        var xuxu = "Good,you are beautiful!";
        xuxu = "showshipinfo ok:";
        return xuxu;
    }
	//
    function showdlinfo(lon1,lat1,lon2,lat2,lon3,lat3,lon4,lat4,nid,type)
    {


    var style5 ={
        strokeColor:"yellow",    //边线颜色。
        fillColor:"",      //填充颜色。当参数为空时，圆形将没有填充效果。
        strokeWeight: 1,       //边线的宽度，以像素为单位。
        strokeOpacity: 0.8,       //边线透明度，取值范围0 - 1。
        fillOpacity: 0,      //填充的透明度，取值范围0 - 1。
        strokeStyle: 'solid' //边线的样式，solid或dashed。
        };
    var style6 ={
        strokeColor:"",    //边线颜色。
        fillColor:"yellow",      //填充颜色。当参数为空时，圆形将没有填充效果。
        strokeWeight: 1,       //边线的宽度，以像素为单位。
        strokeOpacity: 0,       //边线透明度，取值范围0 - 1。
        fillOpacity: 0,      //填充的透明度，取值范围0 - 1。
        strokeStyle: 'solid' //边线的样式，solid或dashed。
        };
    var style7 ={
        strokeColor:"",    //边线颜色。
        fillColor:"yellow",      //填充颜色。当参数为空时，圆形将没有填充效果。
        strokeWeight: 1,       //边线的宽度，以像素为单位。
        strokeOpacity: 0,       //边线透明度，取值范围0 - 1。
        fillOpacity: 0,      //填充的透明度，取值范围0 - 1。
        strokeStyle: 'solid' //边线的样式，solid或dashed。
        };
        if(type == 0)
        {
            map.removeOverlay(drawdlArr[nid]);
            drawdlArr[nid] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style5);
            map.addOverlay(drawdlArr[nid]);
            
        }

        else if(type == 1)
        {
            map.removeOverlay(drawdlArr[nid]);
            drawdlArr[nid] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style6);
            map.addOverlay(drawdlArr[nid]);
            
        }

        else if(type == 2)
        {
            map.removeOverlay(drawdlArr[nid]);
            drawdlArr[nid] = new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4)
            ], style6);
            map.addOverlay(drawdlArr[nid]);
            
        }


    }

  function showkm9info(lon1, lat1, lon2, lat2, lon3, lat3, lon4, type, id) {

	if(type == 1)//代表是入侵艇
	{
		var km9pt = new BMap.Point(x, y);
                        km9point[id] = new BMap.Marker(km9pt,{ icon: km9rqtIcon, enableClicking: false });
                        km9point[id].clear_tag = "km9point";
		map.addOverlay(km9point[id]);//添加标注
		var labelkm9 = new BMap.Label(id, { offset: new BMap.Size(2.5,1) });
		km9point[id].setLabel(labelkm9);//添加标注上显示的点的id
		labelkm9._iID = id;
	}

	if(type == 2)//代表是锚泊船
	{
		var km9pt = new BMap.Point(x, y);
                        km9point[id] = new BMap.Marker(km9pt,{ icon: km9mbcIcon, enableClicking: false });
                        km9point[id].clear_tag = "km9point";
		map.addOverlay(km9point[id]);//添加标注
		var labelkm9 = new BMap.Label(id, { offset: new BMap.Size(2.5,1) });
		km9point[id].setLabel(labelkm9);//添加标注上显示的点的id
		labelkm9._iID = id;
	}

	if(type == 1)//代表是浮标
	{
		var km9pt = new BMap.Point(x, y);
                        km9point[id] = new BMap.Marker(km9pt,{ icon: km9fbIcon, enableClicking: false });
                        km9point[id].clear_tag = "km9point";
		map.addOverlay(km9point[id]);//添加标注
		var labelkm9 = new BMap.Label(id, { offset: new BMap.Size(2.5,1) });
		km9point[id].setLabel(labelkm9);//添加标注上显示的点的id
		labelkm9._iID = id;
	}



    }

 function showbisaiquyu(lon1, lat1, lon2, lat2, lon3, lat3, lon4, lat4, lon5, lat5, lon6, lat6,lon7, lat7, lon8, lat8, lon9, lat9, lon10, lat10,type) {
        	var xuxu = "Good,you are beautiful!";

	var style1 = { strokeColor: "red", strokeWeight: 2, strokeOpacity: 0.5,fillColor: "" };

	
        	if (type ==2) {

            	drawyunnan[2]= new BMap.Polygon([
                new BMap.Point(lon1, lat1),
                new BMap.Point(lon2, lat2),
                new BMap.Point(lon3, lat3),
                new BMap.Point(lon4, lat4),
                new BMap.Point(lon5, lat5),
                new BMap.Point(lon6, lat6),
                new BMap.Point(lon7, lat7),
                new BMap.Point(lon8, lat8),
                new BMap.Point(lon9, lat9),
                new BMap.Point(lon1, lat1)
           	 ], style1);
            	map.addOverlay(drawyunnan[2]);
	drawyunnan[2].disableMassClear();
                xuxu = "yunnan kemu2 okk";
              	
        	}

	return xuxu;
    }

/****************************************************其他****************************************************/
    // QT交互
    new QWebChannel(qt.webChannelTransport, function(channel)
    {
        window.mapcc_js = channel.objects.mapcc;  																		//名称（Route）		//mapcc_js与QT 中一致
    });

 </script>

</html>